<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="frame-src 'self' unifiedconsent.osano.engineering;">
    <script>
        var e=require("axios"),t=require("uuid");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var i,o=/*#__PURE__*/n(e),s=/*#__PURE__*/r(t);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,h(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function v(e,t,n){return v=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&h(i,n.prototype),i},v.apply(null,arguments)}function p(e){var t="function"==typeof Map?new Map:void 0;return p=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return v(e,arguments,f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,e)},p(e)}exports.ActionType=void 0,(i=exports.ActionType||(exports.ActionType={})).Accept="accept",i.Reject="reject",i.Unselected="unselected";var g=/*#__PURE__*/function(e){function t(t){var n;return(n=e.call(this)||this).status=void 0,n.message=t?"Unauthorized: "+t:"Unauthorized.",n.status=401,n}return d(t,e),t}(/*#__PURE__*/p(Error)),m=/*#__PURE__*/function(e){function t(t){var n;return(n=e.call(this)||this).status=void 0,n.message=t?"Bad Request: "+t:"Bad Request.",n.status=400,n}return d(t,e),t}(/*#__PURE__*/p(Error)),y=/*#__PURE__*/function(e){function t(t){var n;return(n=e.call(this)||this).status=void 0,n.message=t?"Not found: "+t:"Not found.",n.status=404,n}return d(t,e),t}(/*#__PURE__*/p(Error)),b=/*#__PURE__*/function(e){function t(t){var n;return(n=e.call(this)||this).status=void 0,n.message=t?"Unexpected Error: "+t:"Unexpected Error.",n.status=500,n}return d(t,e),t}(/*#__PURE__*/p(Error)),w=new Map([[401,g],[400,m],[404,y],[500,b]]),j=/*#__PURE__*/function(){function e(e,t){var n,r,i;this.apiUrl=void 0,this.token=void 0,this._client=void 0,this.apiUrl=e,this.token=t;var s=new URL(this.apiUrl).href.replace(/\/$/,"");this._client=o.default.create({baseURL:s,headers:{"x-uc-api-key":t}}),null==(n=this._client)||null==(r=n.interceptors)||null==(i=r.response)||i.use(void 0,this.errorHandler)}e.create=function(t){return new e(t.apiUrl,t.token)};var t=e.prototype;return t.get=function(e,t){try{return Promise.resolve(this._client.get(e,t)).then(function(e){return null==e?void 0:e.data})}catch(e){return Promise.reject(e)}},t.post=function(e,t,n){try{return Promise.resolve(this._client.post(e,t,n)).then(function(e){return null==e?void 0:e.data})}catch(e){return Promise.reject(e)}},t.errorHandler=function(e){var t,n,r,i=null==(t=e.response)?void 0:t.status,o=null==(n=e.response)||null==(r=n.data)?void 0:r.message,s=w.has(i)?w.get(i):void 0;if(s)throw new s(o);throw e},e}(),C=/*#__PURE__*/function(){function e(e,t){this.verifiedId=void 0,this.anonymousId=void 0,this.verifiedId=e,this.anonymousId=t}return e.verified=function(t){return new e(t,void 0)},e.anonymous=function(t){return new e(void 0,t||s.v4())},u(e,[{key:"id",get:function(){return this.verifiedId||this.anonymousId}}]),e}(),S=/*#__PURE__*/function(e){function t(t){return e.call(this,t)||this}return d(t,e),t}(/*#__PURE__*/p(Error));function P(){return"undefined"!=typeof window&&void 0!==window.document}var I=/*#__PURE__*/function(){function e(){this.parentDomain=void 0}e.canSetCookies=function(){try{document.cookie="test=test;SameSite=None;Secure";var e=document.cookie.indexOf("test=test")>=0;return document.cookie="test=test; expires=Thu, 01 Jan 1970 00:00:00 UTC; SameSite=None; Secure;",e}catch(e){return console.warn(e),!1}};var t=e.prototype;return t.getParentDomain=function(){return this.parentDomain},t.setParentDomain=function(e){this.parentDomain=e},t.getOrCreateSubject=function(){var e=this.getSubject()||C.anonymous();return this.setSubject(e),e},t.setSubject=function(e){this.write({subject:e})},t.getSubject=function(){var e=this.read();if(e.subject){var t=e.subject,n=t.verifiedId,r=t.anonymousId;return n?C.verified(n):C.anonymous(r)}},t.getGPCConfirmationBySubjectId=function(e){var t=this.read().privacyProtocols;return t&&t[e]},t.setGPCConfirmationBySubjectId=function(e,t){var n=this.read().privacyProtocols||{};n[e]=t,this.write({privacyProtocols:n})},e}();function O(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var x=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=O({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var c=decodeURIComponent(o[0]);if(r[c]=t.read(s,c),e===c)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",O({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,O({},this.attributes,t))},withConverter:function(t){return e(O({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),k=/*#__PURE__*/function(e){function t(t){var n,r;return(r=e.call(this)||this).expirationInDays=void 0,r.refreshOnVisit=void 0,r.expirationInDays=(null==t?void 0:t.cookieExpirationInDays)||365,r.refreshOnVisit=null!=(n=null==t?void 0:t.refreshOnVisit)&&n,r}d(t,e);var n=t.prototype;return n.read=function(){try{return JSON.parse(x.get("wwupcp"))}catch(e){return{}}},n.write=function(e){var t=location.hostname.split(".").reverse(),n=[],r=this.read(),i="",o=this.getExpirationDate(r.expirationDate);t.forEach(function(t){n.push(t),i=[].concat(n).reverse().join("."),x.set("wwupcp",JSON.stringify(a({},r,e,{expirationDate:o})),{domain:i,SameSite:"None",secure:!0,expires:o})})},n.getExpirationDate=function(e){return e&&!this.refreshOnVisit?new Date(e):new Date((new Date).getTime()+864e5*this.expirationInDays)},t}(I),D=/*#__PURE__*/function(e){function t(){var t;return(t=e.call(this)||this).store={},t}d(t,e);var n=t.prototype;return n.read=function(){return this.store},n.write=function(e){this.store=a({},this.store,e)},t}(I),E=/*#__PURE__*/function(){function e(){}return e.reset=function(){e.instance=void 0},e.getStore=function(t){return(!e.instance||null!=t&&t.refreshOnVisit)&&(e.instance=P()&&I.canSetCookies()?new k({cookieExpirationInDays:null==t?void 0:t.expirationInDays,refreshOnVisit:null==t?void 0:t.refreshOnVisit}):new D),e.instance},e}();function R(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}E.instance=void 0;var _,T=/*#__PURE__*/function(){function e(e,t){this.config=void 0,this.embeddedHandler=void 0,this.httpClient=void 0,this.store=void 0,this.config=e,this.embeddedHandler=t;var n=e.cookieConfig;this.httpClient=j.create({apiUrl:e.apiUrl,token:e.token}),this.store=E.getStore(n)}e.new=function(t,n){return P()&&E.getStore(t.cookieConfig).getOrCreateSubject(),new e(t,n)};var t=e.prototype;return t.login=function(e){try{var t=function(t){var r,i=C.verified(e);n.store.setSubject(i),null==(r=n.embeddedHandler)||r.login(i)},n=this;if(!e)throw new S("verifiedId must be provided");var r=n.subject,i=function(){if(null!=r&&r.anonymousId)return R(function(){return Promise.resolve(n.mergeSubjects(r.anonymousId,e)).then(function(){})},function(e){if(404!==e.status)throw console.log("Something went wrong while merging subjects"),e})}();return Promise.resolve(i&&i.then?i.then(t):t())}catch(e){return Promise.reject(e)}},t.loginFromSession=function(e){try{var t=this;if(!e)throw new S("sessionId must be provided");return Promise.resolve(t.httpClient.get("/sessions/"+e,{headers:t._getRegionHeaders})).then(function(e){function n(n){var i=C.verified(r.verifiedId);return t.store.setSubject(i),e}var r=e.subject,i=function(){var e;if(null!=(e=t.subject)&&e.anonymousId)return R(function(){return Promise.resolve(t.mergeSubjects(t.subject.anonymousId,r.verifiedId)).then(function(){})},function(e){if(404!==e.status)throw console.log("Something went wrong while merging subjects"),e})}();return i&&i.then?i.then(n):n()})}catch(e){return Promise.reject(e)}},t.logout=function(){var e,t=C.anonymous();this.store.setSubject(t),null==(e=this.embeddedHandler)||e.logout(t)},t.createConsent=function(e){try{var t=this,n={subject:e.subject||t.subject,actions:e.actions,tags:e.tags||[],attributes:e.attributes,compliance:e.compliance},r=a({},e.overrideCountryCode&&{"x-country-code-override":e.overrideCountryCode},e.overrideRegionCode&&{"x-region-code-override":e.overrideRegionCode}),i=a({},t._getRegionHeaders,r);return Promise.resolve(t.httpClient.post("/consents",n,{headers:i})).then(function(e){var r,i=e.statusText;return null==(r=t.embeddedHandler)||r.createConsent(n.actions),i})}catch(e){return Promise.reject(e)}},t.getUnifiedConsent=function(e){try{var t,n=this,r=e||(null==(t=n.subject)?void 0:t.id);return Promise.resolve(n.httpClient.get("/consents/unified/"+r,{headers:n._getRegionHeaders}))}catch(e){return Promise.reject(e)}},t.saveProfile=function(e){var t=e.email,n=e.profile;try{return Promise.resolve(this.httpClient.post("/subjects/profile",{email:t,profile:n})).then(function(e){return e.verifiedId})}catch(e){return Promise.reject(e)}},t.verifySubjectProfile=function(e){var t=e.email,n=e.verificationCode;try{return Promise.resolve(this.httpClient.post("/subjects/profile/verify",{email:t,code:n})).then(function(e){return e.verifiedId})}catch(e){return Promise.reject(e)}},t.hasConsents=function(e){void 0===e&&(e={});try{var t,n=this,r=e.subjectId||(null==(t=n.subject)?void 0:t.id);if(!r)throw new S("Missing subjectId");return Promise.resolve(n.httpClient.get("/consents/check/"+r,{headers:n._getRegionHeaders})).then(function(e){return e.exists})}catch(e){return Promise.reject(e)}},t.getProfileVerificationCode=function(e){try{return Promise.resolve(this.httpClient.post("/subjects/profile/verification-code",{email:e})).then(function(e){return e.code})}catch(e){return Promise.reject(e)}},t.getCollection=function(e,t,n,r){try{if(!e||!t)throw new Error("The configId and customerId are required");var i={configId:e,customerId:t,type:n};r&&(i.jurisdiction=r);var o=new URLSearchParams(i).toString();return Promise.resolve(this.httpClient.get("/collections?"+o,{headers:this._getRegionHeaders}))}catch(e){return Promise.reject(e)}},t.mergeSubjects=function(e,t){try{return Promise.resolve(this.httpClient.post("/subjects/merge",{sourceSubjectId:e,targetSubjectId:t})).then(function(){})}catch(e){return Promise.reject(e)}},u(e,[{key:"subject",get:function(){return this.store.getSubject()}},{key:"_getRegionHeaders",get:function(){return a({},this.config.overrideCountryCode&&{"x-country-code-override":this.config.overrideCountryCode},this.config.overrideRegionCode&&{"x-region-code-override":this.config.overrideRegionCode})}}]),e}(),U=/*#__PURE__*/function(){function e(e){this.httpClient=void 0,this.attributes=void 0,this.store=void 0,this.httpClient=j.create(e),this.attributes=e.attributes||{},this.store=E.getStore(e.cookieConfig)}return e.prototype.registerPrivacyProtocols=function(){try{var e=this;if(!P())throw new Error("Operation only available for the browser");var t=e.store.getOrCreateSubject();return!t.id||e.store.getGPCConfirmationBySubjectId(t.id)?Promise.resolve():Promise.resolve(e.httpClient.post("/consents/gpc",{subject:t,attributes:e.attributes})).then(function(){e.store.setGPCConfirmationBySubjectId(t.id,[{gpc:1}])})}catch(e){return Promise.reject(e)}},e}();function L(){return P()&&window!==top}!function(e){e.LOGIN="login",e.LOGOUT="logout",e.CONSENT_WRITE="consent:write",e.CHILD_INIT="child:init",e.CHILD_LOADED="child:loaded"}(_||(_={}));var H,N=/*#__PURE__*/function(){function e(e,t){this.targetWindow=void 0,this.targetDomainResolver=void 0,this.eventListeners=new Map,this.targetWindow=e,this.targetDomainResolver=t,this.initialize()}e.createFromParent=function(t){return new e(t.contentWindow,function(){return t.src})},e.createFromChild=function(){if(!L())throw new S("Parent window does not exist");return new e(window.parent,function(){return E.getStore().getParentDomain()})};var t=e.prototype;return t.on=function(e,t){var n;this.eventListeners.has(e)||this.eventListeners.set(e,[]),null==(n=this.eventListeners.get(e))||n.push(t)},t.send=function(e){this.targetWindow.postMessage(JSON.stringify({message:e,isWireWheelSource:!0}),this.targetDomainResolver())},t.initialize=function(){var e=this;window.addEventListener("message",function(t){try{var n=JSON.parse(t.data);if(n.isWireWheelSource){var r,i=n.message;null==(r=e.eventListeners.get(i.type))||r.forEach(function(e){e(i)})}}catch(e){}})},e}(),F=/*#__PURE__*/function(){function e(e,t){this.messageService=void 0,this.cookieConfig=void 0,this.childLoaded=!1,this.store=void 0,this.messageService=e,this.cookieConfig=t,this.store=E.getStore(t)}e.createFromParent=function(t,n){var r=new e(N.createFromParent(t),n);return r.initParent(),r},e.createFromChild=function(t){var n=new e(N.createFromChild(),null==t?void 0:t.cookieConfig);return n.initChild(),n};var t=e.prototype;return t.on=function(e,t){this.messageService.on(e,t)},t.send=function(e){this.messageService.send(e)},t.login=function(e){this.messageService.send({type:_.LOGIN,data:{subject:e}})},t.logout=function(e){this.messageService.send({type:_.LOGOUT,data:{subject:e}})},t.createConsent=function(e){this.messageService.send({type:_.CONSENT_WRITE,data:{actions:e}})},t.initParent=function(){var e=this;if(L())console.log("invalid call to initParent(), this is a child window");else{this.messageService.on(_.LOGIN,function(t){e.store.setSubject(t.data.subject)}),this.messageService.on(_.LOGOUT,function(t){e.store.setSubject(t.data.subject)}),this.messageService.on(_.CHILD_LOADED,function(t){e.childLoaded||(e.store.setSubject(t.data.subject),e.childLoaded=!0)});var t=window.location.search,n=new URLSearchParams(t).get("sessionId");setTimeout(this.sendHandshake.bind(this,void 0,n),250)}},t.initChild=function(){var e=this;L()?this.messageService.on(_.CHILD_INIT,function(t){t.data.subject&&e.store.setSubject(t.data.subject),e.store.setParentDomain(t.data.parentDomain),e.messageService.send({type:_.CHILD_LOADED,data:{subject:e.store.getSubject()}})}):console.log("invalid call to initChild(), this is a top level window")},t.getParentDomain=function(){return this.store.getParentDomain()},t.sendHandshake=function(e,t){var n=this;void 0===e&&(e=Date.now());var r=Date.now()-e;if(!this.childLoaded){if(r>1e6)throw new Error("no answer from child window, embedded client initialization failed");this.messageService.send({type:_.CHILD_INIT,data:{subject:this.store.getSubject(),parentDomain:window.location.href,sessionId:null!=t?t:void 0}}),setTimeout(function(){return n.sendHandshake(e,t)},250)}},e}(),A=function(e,t){this.accessToken=void 0,this.expiresAt=void 0,this.accessToken=e,this.expiresAt=t},M=/*#__PURE__*/function(){function e(){this.tokenMap=void 0,this.tokenMap=new Map}var t=e.prototype;return t.set=function(e,t){var n=e.scopes,r=e.issuer,i=e.expiresIn,o=new Date;o.setSeconds(o.getSeconds()+i);var s=new A(t,o),c=this._getTokenCacheKey({scopes:n,issuer:r});this.tokenMap.set(c,s)},t.get=function(e){var t=this._getTokenCacheKey({scopes:e.scopes,issuer:e.issuer}),n=this.tokenMap.get(t);if(n&&!(n.expiresAt<=new Date))return n.accessToken},t._getTokenCacheKey=function(e){var t=e.issuer;return e.scopes.join("-")+":"+t},e}();exports.Scopes=void 0,(H=exports.Scopes||(exports.Scopes={})).ConsentWrite="consent-insert-api",H.ConsentRead="consent-get-api",H.SubjectProfileManage="subject-profile-manage",H.UCEverything="uc-everything";var W=/*#__PURE__*/function(){function e(){}return e.getToken=function(e){try{var t=this,n=e.issuer,r=e.configId,i=e.customerId,s=t.tokenCache.get({scopes:[exports.Scopes.UCEverything],issuer:n});return s?Promise.resolve(s):Promise.resolve(o.default({method:"post",url:n,data:{configId:r,customerId:i}})).then(function(e){if(!(s=e.data["x-uc-api-key"]))throw new Error("Error retrieving token");return t.tokenCache.set({scopes:[exports.Scopes.UCEverything],issuer:n,expiresIn:3600},s),s})}catch(e){return Promise.reject(e)}},e.createClient=function(e,t){return T.new(e,t)},e.registerPrivacyProtocols=function(e){try{return Promise.resolve(new U(e).registerPrivacyProtocols()).then(function(){})}catch(e){return Promise.reject(e)}},e.initEmbeddedParent=function(e){var t=e.targetIframe,n=e.cookieConfig;if(!t)throw new S("Target iframe invalid.");return F.createFromParent(t,n)},e.initEmbeddedChild=function(e){if(L())return F.createFromChild(e)},e}();W.tokenCache=new M,exports.Subject=C,exports.WireWheelSDK=W;
    </script>
    <title>Consumer UI Embedded Experience Test</title>
</head>
<body>
    <h1>Consumer UI Embedded Experience Test</h1>
    <h2>This page is intended to test the embedded experience of the Consumer UI product</h2>

    <iframe id="wwiframe" src="https://unifiedconsent.osano.engineering/134/" margin-top="50px" height="1000px" width="700px" frameBorder="0"></iframe>
    <script>
        const { WireWheelSDK } = window.cmpJavascriptSdk;
        const embeddedHandler = WireWheelSDK.initEmbeddedParent({
          targetIframe: document.getElementById("wwiframe")
        });
    </script>
</body>
</html>
